var ht=Object.defineProperty;var mt=(t,e,r)=>e in t?ht(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var L=(t,e,r)=>(mt(t,typeof e!="symbol"?e+"":e,r),r);const pt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}};pt();function N(){}function ne(t,e){for(const r in e)t[r]=e[r];return t}function Xe(t){return t()}function Ee(){return Object.create(null)}function J(t){t.forEach(Xe)}function gt(t){return typeof t=="function"}function S(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function _t(t){return Object.keys(t).length===0}function V(t,e,r,n){if(t){const i=Qe(t,e,r,n);return t[0](i)}}function Qe(t,e,r,n){return t[1]&&n?ne(r.ctx.slice(),t[1](n(e))):r.ctx}function G(t,e,r,n){if(t[2]&&n){const i=t[2](n(r));if(e.dirty===void 0)return i;if(typeof i=="object"){const s=[],o=Math.max(e.dirty.length,i.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|i[l];return s}return e.dirty|i}return e.dirty}function W(t,e,r,n,i,s){if(i){const o=Qe(e,r,n,s);t.p(o,i)}}function X(t){if(t.ctx.length>32){const e=[],r=t.ctx.length/32;for(let n=0;n<r;n++)e[n]=-1;return e}return-1}function Ae(t){const e={};for(const r in t)r[0]!=="$"&&(e[r]=t[r]);return e}function v(t,e){t.appendChild(e)}function w(t,e,r){t.insertBefore(e,r||null)}function g(t){t.parentNode.removeChild(t)}function re(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function b(t){return document.createElement(t)}function ie(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function B(t){return document.createTextNode(t)}function R(){return B(" ")}function ue(){return B("")}function C(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function wt(t){return function(e){return e.preventDefault(),t.call(this,e)}}function h(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function kt(t){return Array.from(t.childNodes)}function fe(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function se(t,e){t.value=e==null?"":e}function vt(t,e,{bubbles:r=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,r,n,e),i}let K;function j(t){K=t}function Ye(){if(!K)throw new Error("Function called outside component initialization");return K}function ce(t){Ye().$$.on_mount.push(t)}function de(){const t=Ye();return(e,r,{cancelable:n=!1}={})=>{const i=t.$$.callbacks[e];if(i){const s=vt(e,r,{cancelable:n});return i.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}function be(t,e){const r=t.$$.callbacks[e.type];r&&r.slice().forEach(n=>n.call(this,e))}const z=[],oe=[],ee=[],$e=[],bt=Promise.resolve();let ye=!1;function $t(){ye||(ye=!0,bt.then(Ze))}function Te(t){ee.push(t)}function Be(t){$e.push(t)}const we=new Set;let Z=0;function Ze(){const t=K;do{for(;Z<z.length;){const e=z[Z];Z++,j(e),yt(e.$$)}for(j(null),z.length=0,Z=0;oe.length;)oe.pop()();for(let e=0;e<ee.length;e+=1){const r=ee[e];we.has(r)||(we.add(r),r())}ee.length=0}while(z.length);for(;$e.length;)$e.pop()();ye=!1,we.clear(),j(t)}function yt(t){if(t.fragment!==null){t.update(),J(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Te)}}const te=new Set;let F;function le(){F={r:0,c:[],p:F}}function ae(){F.r||J(F.c),F=F.p}function m(t,e){t&&t.i&&(te.delete(t),t.i(e))}function _(t,e,r,n){if(t&&t.o){if(te.has(t))return;te.add(t),F.c.push(()=>{te.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function Tt(t,e){const r={},n={},i={$$scope:1};let s=t.length;for(;s--;){const o=t[s],l=e[s];if(l){for(const a in o)a in l||(n[a]=1);for(const a in l)i[a]||(r[a]=l[a],i[a]=1);t[s]=l}else for(const a in o)i[a]=1}for(const o in n)o in r||(r[o]=void 0);return r}function Pt(t){return typeof t=="object"&&t!==null?t:{}}function Ne(t,e,r){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=r,r(t.$$.ctx[n]))}function P(t){t&&t.c()}function y(t,e,r,n){const{fragment:i,on_mount:s,on_destroy:o,after_update:l}=t.$$;i&&i.m(e,r),n||Te(()=>{const a=s.map(Xe).filter(gt);o?o.push(...a):J(a),t.$$.on_mount=[]}),l.forEach(Te)}function T(t,e){const r=t.$$;r.fragment!==null&&(J(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Rt(t,e){t.$$.dirty[0]===-1&&(z.push(t),$t(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function I(t,e,r,n,i,s,o,l=[-1]){const a=K;j(t);const d=t.$$={fragment:null,ctx:null,props:s,update:N,not_equal:i,bound:Ee(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Ee(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(d.root);let c=!1;if(d.ctx=r?r(t,e.props||{},(u,f,...$)=>{const p=$.length?$[0]:f;return d.ctx&&i(d.ctx[u],d.ctx[u]=p)&&(!d.skip_bound&&d.bound[u]&&d.bound[u](p),c&&Rt(t,u)),f}):[],d.update(),c=!0,J(d.before_update),d.fragment=n?n(d.ctx):!1,e.target){if(e.hydrate){const u=kt(e.target);d.fragment&&d.fragment.l(u),u.forEach(g)}else d.fragment&&d.fragment.c();e.intro&&m(t.$$.fragment),y(t,e.target,e.anchor,e.customElement),Ze()}j(a)}class x{$destroy(){T(this,1),this.$destroy=N}$on(e,r){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!_t(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Le(t){let e,r;return{c(){e=ie("title"),r=B(t[0])},m(n,i){w(n,e,i),v(e,r)},p(n,i){i&1&&fe(r,n[0])},d(n){n&&g(e)}}}function St(t){let e,r,n,i=t[0]&&Le(t);const s=t[3].default,o=V(s,t,t[2],null);return{c(){e=ie("svg"),i&&i.c(),r=ue(),o&&o.c(),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox",t[1]),h(e,"class","svelte-c8tyih")},m(l,a){w(l,e,a),i&&i.m(e,null),v(e,r),o&&o.m(e,null),n=!0},p(l,[a]){l[0]?i?i.p(l,a):(i=Le(l),i.c(),i.m(e,r)):i&&(i.d(1),i=null),o&&o.p&&(!n||a&4)&&W(o,s,l,l[2],n?G(s,l[2],a,null):X(l[2]),null),(!n||a&2)&&h(e,"viewBox",l[1])},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&g(e),i&&i.d(),o&&o.d(l)}}}function It(t,e,r){let{$$slots:n={},$$scope:i}=e,{title:s=null}=e,{viewBox:o}=e;return t.$$set=l=>{"title"in l&&r(0,s=l.title),"viewBox"in l&&r(1,o=l.viewBox),"$$scope"in l&&r(2,i=l.$$scope)},[s,o,i,n]}class xt extends x{constructor(e){super(),I(this,e,It,St,S,{title:0,viewBox:1})}}function Ot(t){let e,r,n;return{c(){e=ie("path"),r=R(),n=ie("path"),h(e,"d","M256 48c-42.9 0-84.2 13-119.2 37.5-34.2 24-60.2 57.2-75.1 96.1L58 192h45.7l1.9-5c8.2-17.8 19.4-33.9 33.5-48 31.2-31.2 72.7-48.4 116.9-48.4s85.7 17.2 116.9 48.4c31.2 31.2 48.4 72.7 48.4 116.9 0 44.1-17.2 85.7-48.4 116.9-31.2 31.2-72.7 48.4-116.9 48.4-44.1 0-85.6-17.2-116.9-48.4-14-14-25.3-30.1-33.5-47.9l-1.9-5H58l3.6 10.4c14.9 38.9 40.9 72.1 75.1 96.1C171.8 451.1 213 464 256 464c114.7 0 208-93.3 208-208S370.7 48 256 48z"),h(n,"d","M48 277.4h189.7l-43.6 44.7L224 352l96-96-96-96-31 29.9 44.7 44.7H48v42.8z")},m(i,s){w(i,e,s),w(i,r,s),w(i,n,s)},p:N,d(i){i&&g(e),i&&g(r),i&&g(n)}}}function Et(t){let e,r;const n=[{viewBox:"0 0 512 512"},t[0]];let i={$$slots:{default:[Ot]},$$scope:{ctx:t}};for(let s=0;s<n.length;s+=1)i=ne(i,n[s]);return e=new xt({props:i}),{c(){P(e.$$.fragment)},m(s,o){y(e,s,o),r=!0},p(s,[o]){const l=o&1?Tt(n,[n[0],Pt(s[0])]):{};o&2&&(l.$$scope={dirty:o,ctx:s}),e.$set(l)},i(s){r||(m(e.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),r=!1},d(s){T(e,s)}}}function At(t,e,r){return t.$$set=n=>{r(0,e=ne(ne({},e),Ae(n)))},e=Ae(e),[e]}class et extends x{constructor(e){super(),I(this,e,At,Et,S,{})}}const H={apiBase:"https://sns-manager.herokuapp.com"},Bt="http://localhost".replace(/\/+$/,"");class tt{constructor(e={}){this.configuration=e}set config(e){this.configuration=e}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:Bt}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||nt}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const e=this.configuration.apiKey;if(e)return typeof e=="function"?e:()=>e}get accessToken(){const e=this.configuration.accessToken;if(e)return typeof e=="function"?e:async()=>e}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}}const Nt=new tt;class Lt{constructor(e=Nt){L(this,"middleware");L(this,"fetchApi",async(e,r)=>{let n={url:e,init:r};for(const s of this.middleware)s.pre&&(n=await s.pre({fetch:this.fetchApi,...n})||n);let i;try{i=await(this.configuration.fetchApi||fetch)(n.url,n.init)}catch(s){for(const o of this.middleware)o.onError&&(i=await o.onError({fetch:this.fetchApi,url:n.url,init:n.init,error:s,response:i?i.clone():void 0})||i);if(i!==void 0)throw new Ct(s,"The request failed and the interceptors did not return an alternative response")}for(const s of this.middleware)s.post&&(i=await s.post({fetch:this.fetchApi,url:n.url,init:n.init,response:i.clone()})||i);return i});this.configuration=e,this.middleware=e.middleware}withMiddleware(...e){const r=this.clone();return r.middleware=r.middleware.concat(...e),r}withPreMiddleware(...e){const r=e.map(n=>({pre:n}));return this.withMiddleware(...r)}withPostMiddleware(...e){const r=e.map(n=>({post:n}));return this.withMiddleware(...r)}async request(e,r){const{url:n,init:i}=await this.createFetchParams(e,r),s=await this.fetchApi(n,i);if(s.status>=200&&s.status<300)return s;throw new Ut(s,"Response returned an error code")}async createFetchParams(e,r){let n=this.configuration.basePath+e.path;e.query!==void 0&&Object.keys(e.query).length!==0&&(n+="?"+this.configuration.queryParamsStringify(e.query));const i=Object.assign({},this.configuration.headers,e.headers);Object.keys(i).forEach(d=>i[d]===void 0?delete i[d]:{});const s=typeof r=="function"?r:async()=>r,o={method:e.method,headers:i,body:e.body,credentials:this.configuration.credentials},l={...o,...await s({init:o,context:e})},a={...l,body:Ft(l.body)||l.body instanceof URLSearchParams||qt(l.body)?l.body:JSON.stringify(l.body)};return{url:n,init:a}}clone(){const e=this.constructor,r=new e(this.configuration);return r.middleware=this.middleware.slice(),r}}function qt(t){return typeof Blob!="undefined"&&t instanceof Blob}function Ft(t){return typeof FormData!="undefined"&&t instanceof FormData}class Ut extends Error{constructor(r,n){super(n);L(this,"name","ResponseError");this.response=r}}class Ct extends Error{constructor(r,n){super(n);L(this,"name","FetchError");this.cause=r}}class M extends Error{constructor(r,n){super(n);L(this,"name","RequiredError");this.field=r}}function Jt(t,e){const r=t[e];return r!=null}function nt(t,e=""){return Object.keys(t).map(r=>rt(r,t[r],e)).filter(r=>r.length>0).join("&")}function rt(t,e,r=""){const n=r+(r.length?`[${t}]`:t);if(e instanceof Array){const i=e.map(s=>encodeURIComponent(String(s))).join(`&${encodeURIComponent(n)}=`);return`${encodeURIComponent(n)}=${i}`}if(e instanceof Set){const i=Array.from(e);return rt(t,i,r)}return e instanceof Date?`${encodeURIComponent(n)}=${encodeURIComponent(e.toISOString())}`:e instanceof Object?nt(e,n):`${encodeURIComponent(n)}=${encodeURIComponent(String(e))}`}function Dt(t){for(const e of t)if(e.contentType==="multipart/form-data")return!0;return!1}class ke{constructor(e,r=n=>n){this.raw=e,this.transformer=r}async value(){return this.transformer(await this.raw.json())}}function Mt(t){if(t!==void 0)return t===null?null:{password:t.password,username:t.username}}function zt(t){return jt(t)}function jt(t,e){return t==null?t:{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}function qe(t){return Kt(t)}function Kt(t,e){return t==null?t:{accessToken:t.access_token,expiresIn:t.expires_in,name:t.name,refreshToken:t.refresh_token,userId:t.user_id,username:t.username}}function Ht(t){if(t!==void 0)return t===null?null:{refresh_token:t.refreshToken}}function Vt(t){return Gt(t)}function Gt(t,e){return t==null?t:{url:Jt(t,"url")?t.url:void 0}}function Wt(t){return Xt(t)}function Xt(t,e){return t==null?t:{accessSecret:t.access_secret,accessToken:t.access_token}}class Qt extends Lt{async pixivAuthPostRaw(e,r){if(e.login===null||e.login===void 0)throw new M("login","Required parameter requestParameters.login was null or undefined when calling pixivAuthPost.");const n={},i={};i["Content-Type"]="application/json";const s=await this.request({path:"/api/pixiv/auth/",method:"POST",headers:i,query:n,body:Mt(e.login)},r);return new ke(s,o=>qe(o))}async pixivAuthPost(e,r){return await(await this.pixivAuthPostRaw(e,r)).value()}async pixivPostPostPostRaw(e,r){if(e.images===null||e.images===void 0)throw new M("images","Required parameter requestParameters.images was null or undefined when calling pixivPostPostPost.");if(e.tags===null||e.tags===void 0)throw new M("tags","Required parameter requestParameters.tags was null or undefined when calling pixivPostPostPost.");if(e.title===null||e.title===void 0)throw new M("title","Required parameter requestParameters.title was null or undefined when calling pixivPostPostPost.");const n={},i={};if(this.configuration&&this.configuration.accessToken){const c=this.configuration.accessToken,u=await c("jwt",[]);u&&(i.Authorization=`Bearer ${u}`)}const o=Dt([{contentType:"multipart/form-data"}]);let l,a=!1;a=o,a?l=new FormData:l=new URLSearchParams,e.images&&e.images.forEach(c=>{l.append("images",c)}),e.tags!==void 0&&l.append("tags",e.tags),e.text!==void 0&&l.append("text",e.text),e.title!==void 0&&l.append("title",e.title);const d=await this.request({path:"/api/pixiv/post",method:"POST",headers:i,query:n,body:l},r);return new ke(d,c=>Vt(c))}async pixivPostPostPost(e,r){return await(await this.pixivPostPostPostRaw(e,r)).value()}async pixivRefreshRefreshPostRaw(e,r){if(e.refreshToken===null||e.refreshToken===void 0)throw new M("refreshToken","Required parameter requestParameters.refreshToken was null or undefined when calling pixivRefreshRefreshPost.");const n={},i={};i["Content-Type"]="application/json";const s=await this.request({path:"/api/pixiv/auth/refresh",method:"POST",headers:i,query:n,body:Ht(e.refreshToken)},r);return new ke(s,o=>qe(o))}async pixivRefreshRefreshPost(e,r){return await(await this.pixivRefreshRefreshPostRaw(e,r)).value()}}const Yt="sns-manager-tokens-",it=localStorage,st=t=>Yt+t,U=t=>{const e=st(t);return JSON.parse(it.getItem(e)||"[]")},ot=(t,e)=>{const r=U(e);if(r.findIndex(n=>n.token===t.accessToken)===-1){const n=lt(t,e);n?(r.push(n),Pe(r,e)):console.log("Invalid token",t)}else console.warn("User is already logged in. Ignoring")},lt=(t,e)=>{const r=e==="twitter",i=r?Wt(t):e==="pixiv"?t:zt(t);return!i||!i.accessToken||r&&!i.accessSecret?null:{token:i.accessToken,refreshToken:i.refreshToken,userId:i.userId,username:i.username}},at=(t,e,r)=>{const n=U(r),i=n.findIndex(o=>o.token===t.token),s=lt(e,r);return s?(n[i]=s,Pe(n,r),s):(console.log("Invalid token",e),null)},ut=(t,e)=>{const n=U(e).filter(i=>i.token!==t.token);Pe(n,e)},Pe=(t,e)=>{const r=st(e);it.setItem(r,JSON.stringify(t))};function Zt(t){let e,r,n,i,s,o;return n=new et({}),{c(){e=b("a"),r=b("div"),P(n.$$.fragment),i=R(),s=B(t[0]),h(r,"class","w-4 h-4"),h(e,"href",t[1]()),h(e,"class","flex flex-row items-center font-bold")},m(l,a){w(l,e,a),v(e,r),y(n,r,null),v(e,i),v(e,s),o=!0},p(l,[a]){(!o||a&1)&&fe(s,l[0])},i(l){o||(m(n.$$.fragment,l),o=!0)},o(l){_(n.$$.fragment,l),o=!1},d(l){l&&g(e),T(n)}}}function en(t,e,r){let{provider:n}=e;const i=de(),s=()=>window.location.origin+window.location.pathname,o=()=>`${H.apiBase}/api/${n}/auth?return_to=${encodeURIComponent(s())}`;return ce(()=>{const a=new URLSearchParams(window.location.search).get(n);if(a){const d=JSON.parse(a);ot(d,n),history.replaceState("","",s()),i("login")}}),t.$$set=l=>{"provider"in l&&r(0,n=l.provider)},[n,o]}class ve extends x{constructor(e){super(),I(this,e,en,Zt,S,{provider:0})}}function tn(t){let e,r,n;return{c(){e=b("input"),h(e,"class","bg-white border py-1 px-2 disabled:bg-gray-200"),h(e,"type","text"),h(e,"name",t[4]),e.disabled=t[1],e.required=t[2],h(e,"placeholder",t[3])},m(i,s){w(i,e,s),se(e,t[0]),r||(n=C(e,"input",t[7]),r=!0)},p(i,s){s&16&&h(e,"name",i[4]),s&2&&(e.disabled=i[1]),s&4&&(e.required=i[2]),s&8&&h(e,"placeholder",i[3]),s&1&&e.value!==i[0]&&se(e,i[0])},d(i){i&&g(e),r=!1,n()}}}function nn(t){let e,r,n;return{c(){e=b("input"),h(e,"class","bg-white border py-1 px-2 disabled:bg-gray-200"),h(e,"type","password"),h(e,"name",t[4]),e.disabled=t[1],e.required=t[2],h(e,"placeholder",t[3])},m(i,s){w(i,e,s),se(e,t[0]),r||(n=C(e,"input",t[6]),r=!0)},p(i,s){s&16&&h(e,"name",i[4]),s&2&&(e.disabled=i[1]),s&4&&(e.required=i[2]),s&8&&h(e,"placeholder",i[3]),s&1&&e.value!==i[0]&&se(e,i[0])},d(i){i&&g(e),r=!1,n()}}}function rn(t){let e;function r(s,o){return s[5]?nn:tn}let n=r(t),i=n(t);return{c(){i.c(),e=ue()},m(s,o){i.m(s,o),w(s,e,o)},p(s,[o]){n===(n=r(s))&&i?i.p(s,o):(i.d(1),i=n(s),i&&(i.c(),i.m(e.parentNode,e)))},i:N,o:N,d(s){i.d(s),s&&g(e)}}}function sn(t,e,r){let{value:n}=e,{disabled:i=!1}=e,{required:s=!1}=e,{placeholder:o=""}=e,{name:l=""}=e,{password:a=!1}=e;function d(){n=this.value,r(0,n)}function c(){n=this.value,r(0,n)}return t.$$set=u=>{"value"in u&&r(0,n=u.value),"disabled"in u&&r(1,i=u.disabled),"required"in u&&r(2,s=u.required),"placeholder"in u&&r(3,o=u.placeholder),"name"in u&&r(4,l=u.name),"password"in u&&r(5,a=u.password)},[n,i,s,o,l,a,d,c]}class Fe extends x{constructor(e){super(),I(this,e,sn,rn,S,{value:0,disabled:1,required:2,placeholder:3,name:4,password:5})}}function on(t){let e,r,n,i;const s=t[3].default,o=V(s,t,t[2],null);return{c(){e=b("button"),o&&o.c(),h(e,"class","disabled:text-gray-500 font-semibold border p-2 rounded"),e.disabled=t[0],h(e,"type",t[1])},m(l,a){w(l,e,a),o&&o.m(e,null),r=!0,n||(i=C(e,"click",t[4]),n=!0)},p(l,[a]){o&&o.p&&(!r||a&4)&&W(o,s,l,l[2],r?G(s,l[2],a,null):X(l[2]),null),(!r||a&1)&&(e.disabled=l[0]),(!r||a&2)&&h(e,"type",l[1])},i(l){r||(m(o,l),r=!0)},o(l){_(o,l),r=!1},d(l){l&&g(e),o&&o.d(l),n=!1,i()}}}function ln(t,e,r){let{$$slots:n={},$$scope:i}=e,{disabled:s=!1}=e,{type:o="button"}=e;function l(a){be.call(this,t,a)}return t.$$set=a=>{"disabled"in a&&r(0,s=a.disabled),"type"in a&&r(1,o=a.type),"$$scope"in a&&r(2,i=a.$$scope)},[s,o,i,n,l]}class an extends x{constructor(e){super(),I(this,e,ln,on,S,{disabled:0,type:1})}}function un(t){let e;return{c(){e=B("Login")},m(r,n){w(r,e,n)},d(r){r&&g(e)}}}function fn(t){let e,r,n,i,s,o,l,a,d,c,u,f,$,p,A,O,he,Re,Q,Se,q,Y,D,me,Ie;n=new et({});function ct(k){t[7](k)}let xe={name:"username",disabled:t[3],placeholder:"Username",required:!0};t[0]!==void 0&&(xe.value=t[0]),$=new Fe({props:xe}),oe.push(()=>Ne($,"value",ct));function dt(k){t[8](k)}let Oe={name:"password",disabled:t[3],placeholder:"Password",required:!0,password:!0};return t[1]!==void 0&&(Oe.value=t[1]),O=new Fe({props:Oe}),oe.push(()=>Ne(O,"value",dt)),q=new an({props:{type:"submit",disabled:t[3],$$slots:{default:[un]},$$scope:{ctx:t}}}),{c(){e=b("button"),r=b("div"),P(n.$$.fragment),i=B(`
  Pixiv`),s=R(),o=b("div"),l=b("div"),a=R(),d=b("div"),c=b("h2"),c.textContent="Pixiv Login",u=R(),f=b("form"),P($.$$.fragment),A=R(),P(O.$$.fragment),Re=R(),Q=b("div"),Q.textContent="Login might be slow or fail often.",Se=R(),P(q.$$.fragment),h(r,"class","w-4 h-4"),h(e,"class","flex flex-row items-center font-bold"),h(l,"class","fixed inset-0 -z-10"),h(c,"class","font-bold"),h(Q,"class","text-xs text-gray-500"),h(f,"class","flex flex-col gap-2 justify-center z-10"),h(d,"class","bg-white flex flex-col justify-center items-center p-4 gap-2"),h(o,"class",Y=`${t[2]?"flex":"hidden"} fixed justify-center items-center inset-0 backdrop-blur-sm `)},m(k,E){w(k,e,E),v(e,r),y(n,r,null),v(e,i),w(k,s,E),w(k,o,E),v(o,l),v(o,a),v(o,d),v(d,c),v(d,u),v(d,f),y($,f,null),v(f,A),y(O,f,null),v(f,Re),v(f,Q),v(f,Se),y(q,f,null),D=!0,me||(Ie=[C(e,"click",t[5]),C(l,"click",t[6]),C(f,"submit",wt(t[9]))],me=!0)},p(k,[E]){const pe={};E&8&&(pe.disabled=k[3]),!p&&E&1&&(p=!0,pe.value=k[0],Be(()=>p=!1)),$.$set(pe);const ge={};E&8&&(ge.disabled=k[3]),!he&&E&2&&(he=!0,ge.value=k[1],Be(()=>he=!1)),O.$set(ge);const _e={};E&8&&(_e.disabled=k[3]),E&2048&&(_e.$$scope={dirty:E,ctx:k}),q.$set(_e),(!D||E&4&&Y!==(Y=`${k[2]?"flex":"hidden"} fixed justify-center items-center inset-0 backdrop-blur-sm `))&&h(o,"class",Y)},i(k){D||(m(n.$$.fragment,k),m($.$$.fragment,k),m(O.$$.fragment,k),m(q.$$.fragment,k),D=!0)},o(k){_(n.$$.fragment,k),_($.$$.fragment,k),_(O.$$.fragment,k),_(q.$$.fragment,k),D=!1},d(k){k&&g(e),T(n),k&&g(s),k&&g(o),T($),T(O),T(q),me=!1,J(Ie)}}}const cn="pixiv";function dn(t,e,r){const n=de();let i="",s="",o=!1,l=!1;const a=async()=>{const p=new Qt(new tt({basePath:H.apiBase}));r(3,l=!0);try{const A=await p.pixivAuthPost({login:{username:i,password:s}});ot(A,cn),n("login"),r(2,o=!1),r(0,i=""),r(1,s="")}catch(A){console.log("Failed to login to pixiv",A)}finally{r(3,l=!1)}},d=()=>r(2,o=!o),c=()=>r(2,o=!1);function u(p){i=p,r(0,i)}function f(p){s=p,r(1,s)}return[i,s,o,l,a,d,c,u,f,()=>a()]}class hn extends x{constructor(e){super(),I(this,e,dn,fn,S,{})}}function Ue(t,e,r){const n=t.slice();return n[3]=e[r],n}function Ce(t){let e,r,n;return{c(){e=b("a"),h(e,"href",r="https://reddit.com"+t[3].link),h(e,"class","w-1/2 h-50v sm:w-1/4 sm:h-25v lg:w-1/6 lg:h-15v bg-cover"),h(e,"style",n=`background-image: url(${t[3].image})`)},m(i,s){w(i,e,s)},p(i,s){s&1&&r!==(r="https://reddit.com"+i[3].link)&&h(e,"href",r),s&1&&n!==(n=`background-image: url(${i[3].image})`)&&h(e,"style",n)},d(i){i&&g(e)}}}function mn(t){let e,r=t[0],n=[];for(let i=0;i<r.length;i+=1)n[i]=Ce(Ue(t,r,i));return{c(){e=b("div");for(let i=0;i<n.length;i+=1)n[i].c();h(e,"class","flex flex-row flex-wrap w-full")},m(i,s){w(i,e,s);for(let o=0;o<n.length;o+=1)n[o].m(e,null)},p(i,[s]){if(s&1){r=i[0];let o;for(o=0;o<r.length;o+=1){const l=Ue(i,r,o);n[o]?n[o].p(l,s):(n[o]=Ce(l),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},i:N,o:N,d(i){i&&g(e),re(n,i)}}}function pn(t,e,r){let{api:n}=e,{username:i}=e,s=[];return ce(async()=>{r(0,s=await n.getUpvoted(i))}),t.$$set=o=>{"api"in o&&r(1,n=o.api),"username"in o&&r(2,i=o.username)},[s,n,i]}class gn extends x{constructor(e){super(),I(this,e,pn,mn,S,{api:1,username:2})}}function _n(t){let e,r;const n=t[2].default,i=V(n,t,t[1],null);return{c(){e=b("a"),i&&i.c(),h(e,"href",t[0]),h(e,"class","text-blue-900 hover:underline"),h(e,"target","_blank")},m(s,o){w(s,e,o),i&&i.m(e,null),r=!0},p(s,[o]){i&&i.p&&(!r||o&2)&&W(i,n,s,s[1],r?G(n,s[1],o,null):X(s[1]),null),(!r||o&1)&&h(e,"href",s[0])},i(s){r||(m(i,s),r=!0)},o(s){_(i,s),r=!1},d(s){s&&g(e),i&&i.d(s)}}}function wn(t,e,r){let{$$slots:n={},$$scope:i}=e,{url:s}=e;return t.$$set=o=>{"url"in o&&r(0,s=o.url),"$$scope"in o&&r(1,i=o.$$scope)},[s,i,n]}class ft extends x{constructor(e){super(),I(this,e,wn,_n,S,{url:0})}}const kn="https://oauth.reddit.com";class vn{constructor(e,r="web:social-media-manager:0.0.1 (by /u/illu11)"){L(this,"headers");this.headers={Authorization:`Bearer ${e}`,"User-Agent":r}}async getJson(e){const r=await fetch(kn+e,{headers:this.headers});return r.status!==200?null:await r.json()}async refreshToken(e){const r=await fetch(H.apiBase+"/api/reddit/auth/refresh",{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});return r.status!==200?null:r.json()}async getUser(){const e=await this.getJson("/api/v1/me");return e?{id:e.id,name:e.name}:null}async getUpvoted(e){const r=await this.getJson(`/user/${e}/upvoted?sort=new&type=link`);return r?r.data.children.map(i=>i.data).map(i=>({link:i.permalink,image:i.url})):[]}}const bn=t=>({api:t&2,username:t&1}),Je=t=>({api:t[1],username:t[0]});function De(t){let e,r,n,i,s;n=new ft({props:{url:`https://reddit.com/u/${t[0]}`,$$slots:{default:[$n]},$$scope:{ctx:t}}});const o=t[3].default,l=V(o,t,t[4],Je);return{c(){e=b("div"),r=b("div"),P(n.$$.fragment),i=R(),l&&l.c(),h(e,"class","flex flex-col gap-2")},m(a,d){w(a,e,d),v(e,r),y(n,r,null),v(e,i),l&&l.m(e,null),s=!0},p(a,d){const c={};d&1&&(c.url=`https://reddit.com/u/${a[0]}`),d&17&&(c.$$scope={dirty:d,ctx:a}),n.$set(c),l&&l.p&&(!s||d&19)&&W(l,o,a,a[4],s?G(o,a[4],d,bn):X(a[4]),Je)},i(a){s||(m(n.$$.fragment,a),m(l,a),s=!0)},o(a){_(n.$$.fragment,a),_(l,a),s=!1},d(a){a&&g(e),T(n),l&&l.d(a)}}}function $n(t){let e,r;return{c(){e=B("Reddit - "),r=B(t[0])},m(n,i){w(n,e,i),w(n,r,i)},p(n,i){i&1&&fe(r,n[0])},d(n){n&&g(e),n&&g(r)}}}function yn(t){let e,r,n=t[0]&&De(t);return{c(){n&&n.c(),e=ue()},m(i,s){n&&n.m(i,s),w(i,e,s),r=!0},p(i,[s]){i[0]?n?(n.p(i,s),s&1&&m(n,1)):(n=De(i),n.c(),m(n,1),n.m(e.parentNode,e)):n&&(le(),_(n,1,1,()=>{n=null}),ae())},i(i){r||(m(n),r=!0)},o(i){_(n),r=!1},d(i){n&&n.d(i),i&&g(e)}}}function Tn(t,e,r){let{$$slots:n={},$$scope:i}=e,{token:s}=e,o,l;const a=de(),d=async u=>{r(1,l=new vn(u.token));const f=await l.getUser();f==null?await c(u):r(0,o=f.name)},c=async u=>{if(u.refreshToken){console.log("Refreshing reddit token");const f=await l.refreshToken(u.refreshToken);f?u=at(u,f,"reddit"):(console.log("Failed to get new token. Removing current token"),ut(u,"reddit")),a("refresh")}};return t.$$set=u=>{"token"in u&&r(2,s=u.token),"$$scope"in u&&r(4,i=u.$$scope)},t.$$.update=()=>{t.$$.dirty&4&&d(s)},[o,l,s,n,i]}class Pn extends x{constructor(e){super(),I(this,e,Tn,yn,S,{token:2})}}const Rn="https://www.pixiv.net";class Sn{constructor(e){L(this,"headers");this.headers={Authorization:`Bearer ${e}`}}async getJson(e){const r=await fetch(H.apiBase+e,{headers:this.headers});return r.status!==200?null:await r.json()}async refreshToken(e){const r=await fetch(H.apiBase+"/api/pixiv/auth/refresh",{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});return r.status!==200?null:r.json()}async getUser(){return await this.getJson("/api/pixiv/ping")?{id:"test",name:"test"}:null}async getBookmarks(e){const r=await this.getJson(`/api/pixiv/bookmarks?user_id=${e}`);return r?r.illusts.map(i=>({link:`${Rn}/artworks/${i.id}`,image:this.formatImageUrl(i.image_urls.medium)})):[]}formatImageUrl(e){return e.replace(/\/c\/\w+\//,"/")}}const In=t=>({api:t&2}),Me=t=>({api:t[1]});function ze(t){let e,r,n,i,s;n=new ft({props:{url:`https://www.pixiv.net/users/${t[0].id}`,$$slots:{default:[xn]},$$scope:{ctx:t}}});const o=t[3].default,l=V(o,t,t[4],Me);return{c(){e=b("div"),r=b("div"),P(n.$$.fragment),i=R(),l&&l.c(),h(e,"class","flex flex-col gap-2")},m(a,d){w(a,e,d),v(e,r),y(n,r,null),v(e,i),l&&l.m(e,null),s=!0},p(a,d){const c={};d&1&&(c.url=`https://www.pixiv.net/users/${a[0].id}`),d&17&&(c.$$scope={dirty:d,ctx:a}),n.$set(c),l&&l.p&&(!s||d&18)&&W(l,o,a,a[4],s?G(o,a[4],d,In):X(a[4]),Me)},i(a){s||(m(n.$$.fragment,a),m(l,a),s=!0)},o(a){_(n.$$.fragment,a),_(l,a),s=!1},d(a){a&&g(e),T(n),l&&l.d(a)}}}function xn(t){let e,r=t[0].name+"",n;return{c(){e=B("Pixiv - "),n=B(r)},m(i,s){w(i,e,s),w(i,n,s)},p(i,s){s&1&&r!==(r=i[0].name+"")&&fe(n,r)},d(i){i&&g(e),i&&g(n)}}}function On(t){let e,r,n=t[0]&&ze(t);return{c(){n&&n.c(),e=ue()},m(i,s){n&&n.m(i,s),w(i,e,s),r=!0},p(i,[s]){i[0]?n?(n.p(i,s),s&1&&m(n,1)):(n=ze(i),n.c(),m(n,1),n.m(e.parentNode,e)):n&&(le(),_(n,1,1,()=>{n=null}),ae())},i(i){r||(m(n),r=!0)},o(i){_(n),r=!1},d(i){n&&n.d(i),i&&g(e)}}}function En(t,e,r){let{$$slots:n={},$$scope:i}=e,{token:s}=e,o,l;const a=de(),d=async u=>{r(1,l=new Sn(u.token)),await l.getUser()==null?await c(u):r(0,o={id:u.userId,name:u.username})},c=async u=>{if(u.refreshToken){console.log("Refreshing pixiv token");const f=await l.refreshToken(u.refreshToken);f?u=at(u,f,"pixiv"):(console.log("Failed to get new token. Removing current token"),ut(u,"pixiv")),a("refresh")}};return t.$$set=u=>{"token"in u&&r(2,s=u.token),"$$scope"in u&&r(4,i=u.$$scope)},t.$$.update=()=>{t.$$.dirty&4&&d(s)},[o,l,s,n,i]}class An extends x{constructor(e){super(),I(this,e,En,On,S,{token:2})}}function je(t,e,r){const n=t.slice();return n[3]=e[r],n}function Ke(t){let e,r,n;return{c(){e=b("a"),h(e,"href",r="https://reddit.com"+t[3].link),h(e,"class","w-1/2 h-50v sm:w-1/4 sm:h-25v lg:w-1/6 lg:h-15v bg-cover"),h(e,"style",n=`background-image: url(${t[3].image})`)},m(i,s){w(i,e,s)},p(i,s){s&1&&r!==(r="https://reddit.com"+i[3].link)&&h(e,"href",r),s&1&&n!==(n=`background-image: url(${i[3].image})`)&&h(e,"style",n)},d(i){i&&g(e)}}}function Bn(t){let e,r=t[0],n=[];for(let i=0;i<r.length;i+=1)n[i]=Ke(je(t,r,i));return{c(){e=b("div");for(let i=0;i<n.length;i+=1)n[i].c();h(e,"class","flex flex-row flex-wrap w-full")},m(i,s){w(i,e,s);for(let o=0;o<n.length;o+=1)n[o].m(e,null)},p(i,[s]){if(s&1){r=i[0];let o;for(o=0;o<r.length;o+=1){const l=je(i,r,o);n[o]?n[o].p(l,s):(n[o]=Ke(l),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},i:N,o:N,d(i){i&&g(e),re(n,i)}}}function Nn(t,e,r){let{api:n}=e,{userId:i}=e,s=[];return ce(async()=>{r(0,s=await n.getBookmarks(i)),console.log(s)}),t.$$set=o=>{"api"in o&&r(1,n=o.api),"userId"in o&&r(2,i=o.userId)},[s,n,i]}class Ln extends x{constructor(e){super(),I(this,e,Nn,Bn,S,{api:1,userId:2})}}function He(t,e,r){const n=t.slice();return n[4]=e[r],n}function Ve(t,e,r){const n=t.slice();return n[4]=e[r],n}function qn(t){let e,r;return e=new gn({props:{api:t[7],username:t[10]}}),{c(){P(e.$$.fragment)},m(n,i){y(e,n,i),r=!0},p(n,i){const s={};i&128&&(s.api=n[7]),i&1024&&(s.username=n[10]),e.$set(s)},i(n){r||(m(e.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function Ge(t){let e,r;return e=new Pn({props:{token:t[4],$$slots:{default:[qn,({api:n,username:i})=>({7:n,10:i}),({api:n,username:i})=>(n?128:0)|(i?1024:0)]},$$scope:{ctx:t}}}),e.$on("refresh",t[2]),{c(){P(e.$$.fragment)},m(n,i){y(e,n,i),r=!0},p(n,i){const s={};i&1&&(s.token=n[4]),i&3200&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){r||(m(e.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function Fn(t){let e,r,n;return e=new Ln({props:{api:t[7],userId:t[4].userId}}),{c(){P(e.$$.fragment),r=R()},m(i,s){y(e,i,s),w(i,r,s),n=!0},p(i,s){const o={};s&128&&(o.api=i[7]),s&2&&(o.userId=i[4].userId),e.$set(o)},i(i){n||(m(e.$$.fragment,i),n=!0)},o(i){_(e.$$.fragment,i),n=!1},d(i){T(e,i),i&&g(r)}}}function We(t){let e,r;return e=new An({props:{token:t[4],$$slots:{default:[Fn,({api:n})=>({7:n}),({api:n})=>n?128:0]},$$scope:{ctx:t}}}),e.$on("refresh",t[3]),{c(){P(e.$$.fragment)},m(n,i){y(e,n,i),r=!0},p(n,i){const s={};i&2&&(s.token=n[4]),i&2178&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){r||(m(e.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function Un(t){let e,r,n,i=t[0],s=[];for(let c=0;c<i.length;c+=1)s[c]=Ge(Ve(t,i,c));const o=c=>_(s[c],1,1,()=>{s[c]=null});let l=t[1],a=[];for(let c=0;c<l.length;c+=1)a[c]=We(He(t,l,c));const d=c=>_(a[c],1,1,()=>{a[c]=null});return{c(){e=b("div");for(let c=0;c<s.length;c+=1)s[c].c();r=R();for(let c=0;c<a.length;c+=1)a[c].c();h(e,"class","flex flex-col")},m(c,u){w(c,e,u);for(let f=0;f<s.length;f+=1)s[f].m(e,null);v(e,r);for(let f=0;f<a.length;f+=1)a[f].m(e,null);n=!0},p(c,[u]){if(u&1153){i=c[0];let f;for(f=0;f<i.length;f+=1){const $=Ve(c,i,f);s[f]?(s[f].p($,u),m(s[f],1)):(s[f]=Ge($),s[f].c(),m(s[f],1),s[f].m(e,r))}for(le(),f=i.length;f<s.length;f+=1)o(f);ae()}if(u&130){l=c[1];let f;for(f=0;f<l.length;f+=1){const $=He(c,l,f);a[f]?(a[f].p($,u),m(a[f],1)):(a[f]=We($),a[f].c(),m(a[f],1),a[f].m(e,null))}for(le(),f=l.length;f<a.length;f+=1)d(f);ae()}},i(c){if(!n){for(let u=0;u<i.length;u+=1)m(s[u]);for(let u=0;u<l.length;u+=1)m(a[u]);n=!0}},o(c){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)_(s[u]);a=a.filter(Boolean);for(let u=0;u<a.length;u+=1)_(a[u]);n=!1},d(c){c&&g(e),re(s,c),re(a,c)}}}function Cn(t,e,r){let{redditTokens:n=[]}=e,{pixivTokens:i=[]}=e;function s(l){be.call(this,t,l)}function o(l){be.call(this,t,l)}return t.$$set=l=>{"redditTokens"in l&&r(0,n=l.redditTokens),"pixivTokens"in l&&r(1,i=l.pixivTokens)},[n,i,s,o]}class Jn extends x{constructor(e){super(),I(this,e,Cn,Un,S,{redditTokens:0,pixivTokens:1})}}function Dn(t){let e,r,n,i,s,o,l,a,d,c,u,f,$;return n=new ve({props:{provider:"twitter"}}),n.$on("login",t[3]),s=new ve({props:{provider:"reddit"}}),s.$on("login",t[4]),l=new ve({props:{provider:"pinterest"}}),l.$on("login",t[5]),d=new hn({}),d.$on("login",t[6]),f=new Jn({props:{redditTokens:t[0],pixivTokens:t[1]}}),f.$on("refresh",t[7]),{c(){e=b("div"),r=b("header"),P(n.$$.fragment),i=R(),P(s.$$.fragment),o=R(),P(l.$$.fragment),a=R(),P(d.$$.fragment),c=R(),u=b("main"),P(f.$$.fragment),h(r,"class","flex flex-row justify-center gap-4 border-b p-2"),h(u,"class","p-4"),h(e,"class","h-full flex flex-col")},m(p,A){w(p,e,A),v(e,r),y(n,r,null),v(r,i),y(s,r,null),v(r,o),y(l,r,null),v(r,a),y(d,r,null),v(e,c),v(e,u),y(f,u,null),$=!0},p(p,[A]){const O={};A&1&&(O.redditTokens=p[0]),A&2&&(O.pixivTokens=p[1]),f.$set(O)},i(p){$||(m(n.$$.fragment,p),m(s.$$.fragment,p),m(l.$$.fragment,p),m(d.$$.fragment,p),m(f.$$.fragment,p),$=!0)},o(p){_(n.$$.fragment,p),_(s.$$.fragment,p),_(l.$$.fragment,p),_(d.$$.fragment,p),_(f.$$.fragment,p),$=!1},d(p){p&&g(e),T(n),T(s),T(l),T(d),T(f)}}}function Mn(t,e,r){let n=[],i=[];const s=()=>{U("twitter"),r(0,n=U("reddit")),r(1,i=U("pixiv")),U("pinterest")};return console.log("%c THIS IS A WARNING ","color: #bc3939; font-size: 16px"),console.log("%c Be careful when executing something in here. It's possible to get your account information","color: #bc3939; font-size: 14px"),ce(()=>s()),[n,i,s,()=>s(),()=>s(),()=>s(),()=>s(),()=>s()]}class zn extends x{constructor(e){super(),I(this,e,Mn,Dn,S,{})}}new zn({target:document.getElementById("app")});
